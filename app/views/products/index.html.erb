<div class="container container-user">

<h1>Products</h1><br/>
<%= render "search"%>

<div class="text-right">
	<%= link_to "New Product", new_product_path if current_user.role == 'admin'%>
</div>
<hr class="hr-table">
<div class="table-responsive">
	<table class="table table-striped table-condensed">
		<thead>
			<tr>
				<th><%= sortable "item_number", "Item Number" %></th>
				<% if current_user.role != 'designer'%>
					<th>Unit Cost</th>
					<th>Tolling Cost</th>
				<% end %>
				<th>Description</th>
				<th>Project</th>
				<th><%= sortable "created_at", "Created at" %></th>
				<th><%= "Action" if current_user.role =="admin"%></th>
			</tr>
		</thead>
		<tbody>
			<% @products.each do |product| %>
				<tr>
					<td><%= link_to product.item_number,  product_path(id: product.id), method: :get%></td>
					<% if product.cost.nil? && current_user.role != 'designer' %>
						<td></td>
						<td></td>
					<% elsif current_user.role == ('admin' || 'user') &&  %>
						<td><%= number_to_currency(product.cost.unitUSD)%></td>
						<td><%= number_to_currency(product.cost.toolingUSD)%></td>
					<% elsif current_user.role == 'factory' %>
						<td><%= number_to_currency(product.cost.unitRMB)%></td>
						<td><%= number_to_currency(product.cost.toolingRMB)%></td>
					<% end %>
					<td><%= product.product_name %></td>
					<td><%= link_to product.project.project_name, controller: "projects", action: "show", id: product.project_id %></td>
					<td><%= product.created_at.strftime("%b %d. %y") %></td>
					<td>
						<%= link_to 'Edit', edit_product_path(id: product.id) if current_user.role =="admin" %>
						<%= link_to 'Delete', product_path(id: product.id), method: :delete, data: {confirm: "Are you sure?"}  if current_user.role =="admin" %>
					</td>
				</tr>			
			<% end %>			
		</tbody>
	</table>
</div>

<%= paginate @products, window: 3, outer_window: 1%>

</div>
